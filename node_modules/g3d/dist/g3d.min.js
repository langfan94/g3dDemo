!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.G3D=t():e.G3D=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=30)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(20),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){return function(r,n,i){var o=r[n],a="__"+n+"ResultCache";return i.value=function(){if(this[e]){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return this[a]=o.call.apply(o,[this].concat(n)),t&&(this[e]=!1),this[a]}return this[a]},i}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t.default},function(e,t,r){"use strict";(function(r,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n){return function(u,s,l){if("function"==typeof u){var c=u;return function(n){function u(){var n;i(this,u);for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];var c=o(this,(n=u.__proto__||Object.getPrototypeOf(u)).call.apply(n,[this].concat(s)));return e.forEach(function(e){var n=c[e];Object.defineProperty(c,e,{get:function(){return n},set:function(e){return n=e,r.isFunction(t)?t.call(this):this[t]=!0,!0}})}),r.isFunction(t)||(c[t]=!0),c}return a(u,n),u}(c)}var f=u;return n[t]=!0,new Proxy(f,{set:function(r,i,o){return r[i]=o,-1!==e.indexOf(i)&&(n[t]=!0),!0}})}}Object.defineProperty(t,"__esModule",{value:!0});var s,l,c,f,h=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.default=u;s=u(["foo","bar"],"ok"),l=n("ok"),s((f=function(){function e(){i(this,e),this.foo=1,this.bar=2,this.obj=u(["x","y","z"],"ok",this)({x:1,y:2,z:1})}return h(e,[{key:"getValue",value:function(){return console.log("get value"),"hello"}}]),e}(),function(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(f.prototype,"getValue",[l],Object.getOwnPropertyDescriptor(f.prototype,"getValue"),f.prototype),c=f));e.exports=t.default}).call(t,r(18),r(1))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=null;t.default={get Image(){return n||Image},set Image(e){n=e},manuallyFlipY:!1,framebufferNotReady:!1},e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.color={r:255,g:255,b:255},this.intensity=1,t.lights.push(this)}return i(e,[{key:"getColor",value:function(){return[this.color.r,this.color.g,this.color.b]}},{key:"getIntensity",value:function(){return this.intensity}}]),e}();t.default=o,e.exports=t.default},function(e,t,r){"use strict";(function(r,n,i,o){function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function(e){function t(e){a(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.geometry=new n(r),r.materials={default:new i(r)},r.scene=null,r.visibility=!0,r.pickable=!0,r.renderLayerIndex=0,r.scene=e,r.scene.meshes.push(r),r}return s(t,e),l(t,[{key:"dispose",value:function(){var e=o.findIndex(this.scene.meshes,{id:this.id});-1!==e&&this.scene.meshes.splice(e,1)}},{key:"getGlobalVisibility",value:function(){for(var e=this;null!==e;){if(!e.visibility)return!1;e=e.parent}return!0}},{key:"getPickable",value:function(){return this.pickable}},{key:"getRenderLayerIndex",value:function(){for(var e=this;null!==e;){if(0!==e.renderLayerIndex)return e.renderLayerIndex;e=e.parent}return 0}}]),t}(r);t.default=c,e.exports=t.default}).call(t,r(8),r(10),r(7),r(18))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){n(this,e),this.opacity=1,this.offset={x:0,y:0}}return i(e,[{key:"getOpacity",value:function(){return this.opacity}},{key:"getOffset",value:function(){return new Float32Array([this.offset.x,this.offset.y])}}]),e}();o.COLOR=1,o.TEXTURE=2,t.default=o,e.exports=t.default},function(e,t,r){"use strict";(function(r,n,i,o,a){function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var f,h,p,v,y=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),d=(f=r("isDirty"),h=r("isDirty"),p=r("isDirty"),v=function(e){function t(e){u(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.ambientColor=i(["r","g","b"],"isDirty",r)({r:255,g:255,b:255}),r.ambientTexture=new o(r),r.ambientSource=n.COLOR,r.diffuseColor=i(["r","g","b"],"isDirty",r)({r:255,g:255,b:255}),r.diffuseTexture=new o(r),r.diffuseSource=n.COLOR,r.specularColor=i(["r","g","b"],"isDirty",r)({r:0,g:0,b:0}),r.specularTexture=new o(r),r.specularSource=n.COLOR,r.glossiness=1,r.envMapTexture=new o(r),r.useEnvMap=!1,r.mesh=null,r.mesh=e,r}return l(t,e),y(t,[{key:"getAmbientSource",value:function(){return this.ambientSource}},{key:"getAmbientColor",value:function(){return a.fromValues(this.ambientColor.r/255,this.ambientColor.g/255,this.ambientColor.b/255)}},{key:"getDiffuseSource",value:function(){return this.diffuseSource}},{key:"getDiffuseColor",value:function(){return a.fromValues(this.diffuseColor.r/255,this.diffuseColor.g/255,this.diffuseColor.b/255)}},{key:"getSpecularSource",value:function(){return this.specularSource}},{key:"getSpecularColor",value:function(){return a.fromValues(this.specularColor.r/255,this.specularColor.g/255,this.specularColor.b/255)}},{key:"getGlossiness",value:function(){return this.glossiness}},{key:"getUseEnvMap",value:function(){return this.useEnvMap}}]),t}(n),c(v.prototype,"getAmbientColor",[f],Object.getOwnPropertyDescriptor(v.prototype,"getAmbientColor"),v.prototype),c(v.prototype,"getDiffuseColor",[h],Object.getOwnPropertyDescriptor(v.prototype,"getDiffuseColor"),v.prototype),c(v.prototype,"getSpecularColor",[p],Object.getOwnPropertyDescriptor(v.prototype,"getSpecularColor"),v.prototype),v);t.default=d,e.exports=t.default}).call(t,r(1),r(6),r(2),r(23),r(0))},function(e,t,r){"use strict";(function(r,n,i,o,a,u){function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var l,c,f,h,p=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),v=1,y=(l=r([],"isDirty"),c=n("isDirty"),l((h=function(){function e(){s(this,e),this.id=v++,this.position=r(["x","y","z"],"isDirty",this)({x:0,y:0,z:0}),this.rotation=r(["x","y","z"],"isDirty",this)({x:0,y:0,z:0}),this.scale=r(["x","y","z"],"isDirty",this)({x:1,y:1,z:1}),this.parent=null}return p(e,[{key:"getWorldMatrix",value:function(){if(this.parent){var e=this.parent.getWorldMatrix();return i.multiply(i.create(),e,this.getMatrix())}return this.getMatrix()}},{key:"getMatrix",value:function(){var e=o.create();o.fromEuler(e,this.rotation.x,this.rotation.y,this.rotation.z);var t=a.fromValues(this.position.x,this.position.y,this.position.z),r=a.fromValues(this.scale.x,this.scale.y,this.scale.z),n=i.create();return i.fromRotationTranslationScale(n,e,t,r),n}},{key:"transformCoordinate",value:function(e,t,r){var n=this.getMatrix(),i=a.fromValues(e,t,r),o=a.transformMat4(a.create(),i,n);return{x:o[0],y:o[1],z:o[2]}}},{key:"transformNormal",value:function(e,t,r){var n=this.getMatrix(),i=u.fromValues(e,t,r,0),o=u.transformMat4(u.create(),i,n);return{x:o[0],y:o[1],z:o[2]}}}]),e}(),function(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(h.prototype,"getMatrix",[c],Object.getOwnPropertyDescriptor(h.prototype,"getMatrix"),h.prototype),f=h))||f);t.default=y,e.exports=t.default}).call(t,r(2),r(1),r(9),r(19),r(0),r(22))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(40),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.default=i,e.exports=t.default},function(e,t,r){"use strict";(function(r,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o,a,u,s,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=(o=r(["vertices","uvs","normals","indices"],"isDirty"),a=n("isDirty",!0),o((s=function(){function e(t){i(this,e),this.vertices=[],this.indices={default:[]},this.uvs=[],this.normals=[],this.mesh=t}return c(e,[{key:"getVertices",value:function(){return new Float32Array(this.vertices)}},{key:"getUVs",value:function(){return new Float32Array(this.uvs)}},{key:"getNormals",value:function(){return new Float32Array(this.normals)}},{key:"getIndices",value:function(){var e=l({},this.indices);for(var t in e)e[t]=new Uint32Array(e[t]);return e}},{key:"getBuffers",value:function(){var e=this.mesh.scene.engine,t=e.createAttributeBuffer(this.getVertices()),r=e.createAttributeBuffer(this.getUVs()),n=e.createAttributeBuffer(this.getNormals()),i={},o={},a=this.getIndices();for(var u in a)i[u]=e.createElementBuffer(a[u]),o[u]=a[u].length;return{vertices:t,uvs:r,normals:n,indices:i,indicesLength:o}}},{key:"mergeNormals",value:function(){for(var e=this.vertices,t=this.normals,r={},n=0;n<e.length;n+=3){var i=[e[n],e[n+1],e[n+2]].join(",");r[i]||(r[i]={indices:[],normal:[0,0,0]});var o=r[i];o.indices.push(n/3),o.normal[0]+=t[n],o.normal[1]+=t[n+1],o.normal[2]+=t[n+2]}for(var a in r)for(var u=r[a],s=u.indices,l=u.normal,c=0;c<s.length;c++){var f=s[c];t[3*f]=l[0]/s.length,t[3*f+1]=l[1]/s.length,t[3*f+2]=l[2]/s.length}}},{key:"mergeNormals2",value:function(){for(var e=[],t=this.vertices,r=this.normals,n=0;n<t.length;n+=3)if(!e[n]){for(var i=[n/3],o=[r[n],r[n+1],r[n+2]],a=n+3;a<n+t.length;a+=3)t[n]===t[a]&&t[n+1]===t[a+1]&&t[n+2]===t[a+2]&&(i.push(a/3),o[0]+=r[a],o[1]+=r[a+1],o[2]+=r[a+2]);for(var u=0;u<i.length;u++){var s=i[u];r[3*s]=o[0]/i.length,r[3*s+1]=o[1]/i.length,r[3*s+2]=o[2]/i.length,e[s]=!0}}}}]),e}(),function(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(s.prototype,"getBuffers",[a],Object.getOwnPropertyDescriptor(s.prototype,"getBuffers"),s.prototype),u=s))||u);t.default=f,e.exports=t.default}).call(t,r(2),r(1))},function(e,t,r){"use strict";(function(r,n,i){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.geometry=new n(r),r.materials={default:new i(r)},r.lineWidth=2,r}return u(t,e),t}(r);t.default=s,e.exports=t.default}).call(t,r(5),r(24),r(12))},function(e,t,r){"use strict";(function(r,n,i,o,a){function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c,f,h=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),p=(c=r("isDirty"),f=function(e){function t(e){u(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.color=i(["r","g","b"],"isDirty",r)({r:255,g:255,b:255}),r.texture=new o(r),r.source=n.COLOR,r.mesh=null,r.mesh=e,r}return l(t,e),h(t,[{key:"getSource",value:function(){return this.source}},{key:"getColor",value:function(){return a.fromValues(this.color.r/255,this.color.g/255,this.color.b/255)}}]),t}(n),function(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(f.prototype,"getColor",[c],Object.getOwnPropertyDescriptor(f.prototype,"getColor"),f.prototype),f);t.default=p,e.exports=t.default}).call(t,r(1),r(6),r(2),r(23),r(0))},function(e,t,r){"use strict";(function(r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.direction={x:0,y:0,z:-1},r}return o(t,e),a(t,[{key:"getDirection",value:function(){return[this.direction.x,this.direction.y,this.direction.z]}}]),t}(r);t.default=u,e.exports=t.default}).call(t,r(4))},function(e,t,r){"use strict";(function(r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function(e){function t(){var e;n(this,t);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];var u=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return u.sky={r:255,g:255,b:255},u.ground={r:0,g:0,b:0},u.up={x:0,y:1,z:0},u}return o(t,e),a(t,[{key:"getSky",value:function(){return[this.sky.r,this.sky.g,this.sky.b]}},{key:"getGround",value:function(){return[this.ground.r,this.ground.g,this.ground.b]}},{key:"getUp",value:function(){return[this.up.x,this.up.y,this.up.z]}}]),t}(r);t.default=u,e.exports=t.default}).call(t,r(4))},function(e,t,r){"use strict";(function(r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return n(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),t}(r);t.default=a,e.exports=t.default}).call(t,r(4))},function(e,t,r){"use strict";(function(r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},s=function(e){function t(){var e,r,o,a;n(this,t);for(var u=arguments.length,s=Array(u),l=0;l<u;l++)s[l]=arguments[l];return r=o=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.position={x:0,y:0,z:0},o.radius=1,a=r,i(o,a)}return o(t,e),a(t,[{key:"getPosition",value:function(){return[this.position.x,this.position.y,this.position.z]}},{key:"getIntensity",value:function(){return u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getIntensity",this).call(this)*this.radius*this.radius}}]),t}(r);t.default=s,e.exports=t.default}).call(t,r(4))},function(e,t,r){"use strict";(function(r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function(e){function t(){var e;n(this,t);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];var u=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return u.morphTargetsGeometries=[],u.cycleDuration=1e3,u}return o(t,e),a(t,[{key:"getMorphPhaseInfo",value:function(){var e=Date.now()/this.cycleDuration%1,t=1/this.morphTargetsGeometries.length,r=Math.floor(e/t),n=Math.ceil(e/t);return n===this.morphTargetsGeometries.length&&(n=0),{before:r,after:n,phase:e/t-r}}}]),t}(r);t.default=u,e.exports=t.default}).call(t,r(5))},function(e,t,r){"use strict";function n(e,t){if(o(t))return!!t(e);for(var r in t)if(t[r]!==e[r])return!1;return!0}function i(e,t){for(var r=0;r<e.length;r++)if(n(e[r],t))return r;return-1}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return"function"==typeof e};t.default={isFunction:o,findIndex:i},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(41),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}function i(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function o(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function a(e,t,r){var n=new Float32Array(3);return n[0]=e,n[1]=t,n[2]=r,n}function u(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function s(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function l(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function c(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function f(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function h(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function p(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function v(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function y(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function d(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function m(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function b(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function g(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function M(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function _(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function x(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function T(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function E(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function P(e,t){var r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}function w(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function O(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],u=r[1],s=r[2];return e[0]=i*s-o*u,e[1]=o*a-n*s,e[2]=n*u-i*a,e}function A(e,t,r,n){var i=t[0],o=t[1],a=t[2];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e}function R(e,t,r,n,i,o){var a=o*o,u=a*(2*o-3)+1,s=a*(o-2)+o,l=a*(o-1),c=a*(3-2*o);return e[0]=t[0]*u+r[0]*s+n[0]*l+i[0]*c,e[1]=t[1]*u+r[1]*s+n[1]*l+i[1]*c,e[2]=t[2]*u+r[2]*s+n[2]*l+i[2]*c,e}function C(e,t,r,n,i,o){var a=1-o,u=a*a,s=o*o,l=u*a,c=3*o*u,f=3*s*a,h=s*o;return e[0]=t[0]*l+r[0]*c+n[0]*f+i[0]*h,e[1]=t[1]*l+r[1]*c+n[1]*f+i[1]*h,e[2]=t[2]*l+r[2]*c+n[2]*f+i[2]*h,e}function j(e,t){t=t||1;var r=2*Math.random()*Math.PI,n=2*Math.random()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function F(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,e}function k(e,t,r){var n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}function L(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],u=r[1],s=r[2],l=r[3],c=l*n+u*o-s*i,f=l*i+s*n-a*o,h=l*o+a*i-u*n,p=-a*n-u*i-s*o;return e[0]=c*l+p*-a+f*-s-h*-u,e[1]=f*l+p*-u+h*-a-c*-s,e[2]=h*l+p*-s+c*-u-f*-a,e}function S(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function D(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function I(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function U(e,t){var r=a(e[0],e[1],e[2]),n=a(t[0],t[1],t[2]);P(r,r),P(n,n);var i=w(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)}function z(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function N(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function V(e,t){var r=e[0],n=e[1],i=e[2],o=t[0],a=t[1],u=t[2];return Math.abs(r-o)<=B*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-a)<=B*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=B*Math.max(1,Math.abs(i),Math.abs(u))}Object.defineProperty(t,"__esModule",{value:!0}),t.create=n,t.clone=i,t.length=o,t.fromValues=a,t.copy=u,t.set=s,t.add=l,t.subtract=c,t.multiply=f,t.divide=h,t.ceil=p,t.floor=v,t.min=y,t.max=d,t.round=m,t.scale=b,t.scaleAndAdd=g,t.distance=M,t.squaredDistance=_,t.squaredLength=x,t.negate=T,t.inverse=E,t.normalize=P,t.dot=w,t.cross=O,t.lerp=A,t.hermite=R,t.bezier=C,t.random=j,t.transformMat4=F,t.transformMat3=k,t.transformQuat=L,t.rotateX=S,t.rotateY=D,t.rotateZ=I,t.angle=U,t.str=z,t.exactEquals=N,t.equals=V;var B=1e-6;t.sub=c,t.mul=f,t.div=h,t.dist=M,t.sqrDist=_,t.len=o,t.sqrLen=x,t.forEach=function(){var e=n();return function(t,r,n,i,o,a){var u=void 0,s=void 0;for(r||(r=3),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],o(e,e,a),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2];return t}}()},function(e,t,r){"use strict";function n(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function i(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function o(e,t,r,n){var i=new Float32Array(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function u(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function s(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function l(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function c(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function f(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function h(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function p(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function v(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function y(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function d(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function m(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function b(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function g(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+o*o)}function M(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+i*i+o*o}function _(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function x(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function T(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function E(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function P(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=o*a),e}function w(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function O(e,t,r,n){var i=t[0],o=t[1],a=t[2],u=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e[3]=u+n*(r[3]-u),e}function A(e,t){return t=t||1,e[0]=Math.random(),e[1]=Math.random(),e[2]=Math.random(),e[3]=Math.random(),P(e,e),m(e,e,t),e}function R(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e}function C(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],u=r[1],s=r[2],l=r[3],c=l*n+u*o-s*i,f=l*i+s*n-a*o,h=l*o+a*i-u*n,p=-a*n-u*i-s*o;return e[0]=c*l+p*-a+f*-s-h*-u,e[1]=f*l+p*-u+h*-a-c*-s,e[2]=h*l+p*-s+c*-u-f*-a,e[3]=t[3],e}function j(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function F(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function k(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=t[0],u=t[1],s=t[2],l=t[3];return Math.abs(r-a)<=L*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-u)<=L*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-s)<=L*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-l)<=L*Math.max(1,Math.abs(o),Math.abs(l))}Object.defineProperty(t,"__esModule",{value:!0}),t.create=n,t.clone=i,t.fromValues=o,t.copy=a,t.set=u,t.add=s,t.subtract=l,t.multiply=c,t.divide=f,t.ceil=h,t.floor=p,t.min=v,t.max=y,t.round=d,t.scale=m,t.scaleAndAdd=b,t.distance=g,t.squaredDistance=M,t.length=_,t.squaredLength=x,t.negate=T,t.inverse=E,t.normalize=P,t.dot=w,t.lerp=O,t.random=A,t.transformMat4=R,t.transformQuat=C,t.str=j,t.exactEquals=F,t.equals=k;var L=1e-6;t.sub=l,t.mul=c,t.div=f,t.dist=g,t.sqrDist=M,t.len=_,t.sqrLen=x,t.forEach=function(){var e=n();return function(t,r,n,i,o,a){var u=void 0,s=void 0;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,t.length):t.length,u=n;u<s;u+=r)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],e[3]=t[u+3],o(e,e,a),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];return t}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(21),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);t.default=i,e.exports=t.default},function(e,t,r){"use strict";(function(r,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o,a,u,s,l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=(o=r(["image"],"isDirty"),a=n("isDirty",!0),o((s=function(){function e(t){i(this,e),this.offset={x:0,y:0},this.image=new Uint8Array([255,255,255,255]),this.material=null,this.material=t}return l(e,[{key:"getImage",value:function(){return this.image}},{key:"getTexture",value:function(){return this.material.mesh.scene.engine.createTexture(this.getImage())}}]),e}(),function(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(s.prototype,"getTexture",[a],Object.getOwnPropertyDescriptor(s.prototype,"getTexture"),s.prototype),u=s))||u);t.default=c,e.exports=t.default}).call(t,r(2),r(1))},function(e,t,r){"use strict";(function(r,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o,a,u,s,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=(o=r(["vertices","indices"],"isDirty"),a=n("isDirty",!0),o((s=function(){function e(t){i(this,e),this.vertices=[],this.indices={default:[]},this.mesh=null,this.mesh=t}return c(e,[{key:"getVertices",value:function(){return new Float32Array(this.vertices)}},{key:"getIndices",value:function(){var e=l({},this.indices);for(var t in e)e[t]=new Uint32Array(e[t]);return e}},{key:"getBuffers",value:function(){for(var e=this.mesh.scene.engine,t=this.getVertices(),r=e.createAttributeBuffer(t),n={},i={},o=[],a=[],u=0;u<t.length;u+=3)o.push(0,0),a.push(0,0,1);var s=e.createAttributeBuffer(new Float32Array(o)),l=e.createAttributeBuffer(new Float32Array(a)),c=this.getIndices();for(var f in c)n[f]=e.createElementBuffer(c[f]),i[f]=c[f].length;return{vertices:r,indices:n,indicesLength:i,uvs:s,normals:l}}}]),e}(),function(e,t,r,n,i){var o={};return Object.keys(n).forEach(function(e){o[e]=n[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(s.prototype,"getBuffers",[a],Object.getOwnPropertyDescriptor(s.prototype,"getBuffers"),s.prototype),u=s))||u);t.default=f,e.exports=t.default}).call(t,r(2),r(1))},function(e,t,r){"use strict";(function(r,n,i,o,a){function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=function(e){function t(e){u(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.scene=null,r.center={x:0,y:0,z:0},r.up={x:0,y:1,z:0},r.near=1,r.far=1e3,r.fov=90,r.scene=e,e.activeCamera=r,r}return l(t,e),c(t,[{key:"getVMatrix",value:function(){var e=n.create(),t=i.fromValues(this.center.x,this.center.y,this.center.z),r=i.fromValues(this.up.x,this.up.y,this.up.z),o=i.fromValues(this.position.x,this.position.y,this.position.z);n.lookAt(e,o,t,r),n.invert(e,e);var a=n.create();return n.invert(a,e),a}},{key:"getPMatrix",value:function(){var e=this.scene,t=this.near,r=this.far,i=this.fov,a=e.engine,u=a.width,s=a.height;return n.perspective(n.create(),o.deg2rad(i),u/s,t,r)}},{key:"getPosition",value:function(){return new Float32Array([this.position.x,this.position.y,this.position.z])}},{key:"getViewRay",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.scene.engine,u=o.width,s=o.height;r&&(t=s-t);var l=2*(e/u-.5),c=2*(t/s-.5),f=this.getPMatrix(),h=i.fromValues(l,c,1);i.transformMat4(h,h,n.invert(n.create(),f)),i.transformMat4(h,h,n.invert(n.create(),this.getVMatrix()));var p=i.sub(i.create(),h,i.fromValues(this.position.x,this.position.y,this.position.z)),v=new a;return v.origin.x=this.position.x,v.origin.y=this.position.y,v.origin.z=this.position.z,v.direction.x=p[0],v.direction.y=p[1],v.direction.z=p[2],v}}]),t}(r);t.default=f,e.exports=t.default}).call(t,r(8),r(9),r(0),r(26),r(27))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={rad2deg:function(e){return 180*e/Math.PI},deg2rad:function(e){return e*Math.PI/180}},e.exports=t.default},function(e,t,r){"use strict";(function(r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){n(this,e),this.origin={x:0,y:0,z:0},this.direction={x:0,y:0,z:1}}return i(e,[{key:"intersectPlane",value:function(e){var t=e.normal,n=e.offset,i=this.distanceToPlane({normal:t,offset:n});if(null===i)return null;var o=r.fromValues(this.origin.x,this.origin.y,this.origin.z),a=r.normalize(r.create(),r.fromValues(this.direction.x,this.direction.y,this.direction.z)),u=r.scale(r.create(),a,i),s=r.add(r.create(),o,u);return{x:s[0],y:s[1],z:s[2]}}},{key:"distanceToPlane",value:function(e){var t=e.normal,n=e.offset;t=r.normalize(r.create(),r.fromValues(t.x,t.y,t.z));var i=r.fromValues(this.origin.x,this.origin.y,this.origin.z),o=r.normalize(r.create(),r.fromValues(this.direction.x,this.direction.y,this.direction.z)),a=r.dot(t,o);if(0===a)return null;var u=-(r.dot(i,t)-n)/a;return u>0?u:null}}]),e}();t.default=o,e.exports=t.default}).call(t,r(0))},function(e,t,r){"use strict";(function(r){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,a=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,u=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,s=/f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,l=/f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,c=/^usemtl /,f=/^mtllib /,h=/^g/,p={parse:function(e){function t(e){y(e).forEach(function(e){var t=e.split("/").map(function(e){return Number(e)-1}),r=i(t,3);v(r[0],r[1],r[2])})}function p(e){var t=y(e),o=0;t.forEach(function(e,t,a){var u=e.split("/").map(function(e){return Number(e)-1}),s=i(u,2),l=s[0],c=s[1];if(t%3==0){var f,h,p,y=(f=r).fromValues.apply(f,n(m[l])),d=a[t+1].split("/").map(function(e){return Number(e)-1}),g=i(d,1),M=g[0],_=(h=r).fromValues.apply(h,n(m[M])),x=a[t+2].split("/").map(function(e){return Number(e)-1}),T=i(x,1),E=T[0],P=(p=r).fromValues.apply(p,n(m[E])),w=r.sub(r.create(),_,y),O=r.sub(r.create(),P,y),A=r.cross(r.create(),w,O);b.push([].concat(n(A))),o=b.length-1}v(l,c,o)})}function v(e,t,r){if(M[e]){var n=d(M[e].uvs,t,M[e].normals,r);-1!==n?_.indices[T].push(M[e].pos[n]):(M[e].uvs.push(t),M[e].normals.push(r),M[e].pos.push(x),_.positions.push(m[e]),_.uvs.push(g[t]),_.normals.push(b[r]),_.indices[T].push(x++))}else M[e]={uvs:[t],normals:[r],pos:[x]},_.positions.push(m[e]),_.uvs.push(g[t]),_.normals.push(b[r]),_.indices[T].push(x++)}function y(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=1;r+1<e.length;)t.push(e[0],e[r],e[r+1]),r++;return t}function d(e,t,r,n){for(var i=e.map(function(e,t){return{value:e,i:t}}).filter(function(e){return e.value===t}).map(function(e){return e.i}),o=0;o<i.length;o++)if(r[i[o]]===n)return i[o];return-1}var m=[],b=[],g=[],M=[],_={positions:[],uvs:[],normals:[],indices:{},mtls:e.mtl?this.parseMtl(e.mtl):{}},x=0,T=null;return e.obj.split("\n").forEach(function(e){e=e.trim();var r=void 0;if(0!==e.length&&"#"!==e.charAt(0))if(null!==(r=o.exec(e)))m.push(r.splice(1).map(Number));else if(null!==(r=a.exec(e)))b.push(r.splice(1).map(Number));else if(null!==(r=u.exec(e)))g.push(r.splice(1).map(Number));else if(null!==(r=l.exec(e)))t(r[1].trim().split(" "));else if(null!==(r=s.exec(e)))p(r[1].trim().split(" "));else if(c.test(e)){var n=e.substring(7).trim();_.indices[n]||(_.indices[n]=[]),T=n}else f.test(e)?e.substring(7).trim():h.test(e)?e.substring(2).trim():console.log("Unhandled expression at line : "+e)}),_},parseMtl:function(e){var t=e.split("\n"),r={},n=null;return t.forEach(function(e){if(e=e.trim(),0!==e.length&&"#"!==e.charAt(0)){var t=e.indexOf(" "),i=(t>=0?e.substring(0,t):e).toLowerCase(),o=t>=0?e.substring(t+1).trim():"";"newmtl"===i?(r[o]={},n=o):"kd"===i?r[n].diffuseColor=o.split(" ").map(Number):"ka"===i?r[n].ambientColor=o.split(" ").map(Number):"ks"===i?r[n].specularColor=o.split(" ").map(Number):"map_kd"===i?r[n].diffuseTexture=o:"map_ka"===i?r[n].ambientTexture=o:"map_ks"===i?r[n].specularTexture=o:"ns"===i?r[n].glossiness=Number(o):console.log("Unhandled expression at line : "+e)}}),r}};t.default=p,e.exports=t.default}).call(t,r(0))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={parse:function(e){return e instanceof ArrayBuffer?this.parseBinary(e):this.parseASCII(e)},parseBinary:function(e){for(var t=new DataView(e),r=t.getUint32(80,!0),n=[],i=[],o=[],a=[],u=0;u<r;u++)for(var s=84+50*u,l=t.getFloat32(s,!0),c=t.getFloat32(s+4,!0),f=t.getFloat32(s+8,!0),h=1;h<=3;h++){var p=s+12*h;n.push(t.getFloat32(p,!0)),n.push(t.getFloat32(p+4,!0)),n.push(t.getFloat32(p+8,!0)),i.push(l,c,f),o.push(0,0),a.push(a.length)}return{positions:n,normals:i,uvs:o,indices:a}},parseASCII:function(e){for(var t=/facet([\s\S]*?)endfacet/g,r=/[\s]+([+-]?(?:\d+.\d+|\d+.|\d+|.\d+)(?:[eE][+-]?\d+)?)/.source,n=new RegExp("vertex"+r+r+r,"g"),i=new RegExp("normal"+r+r+r,"g"),o=0,a=[],u=[],s=[],l=[],c={x:0,y:0,z:0},f=void 0;null!==(f=t.exec(e));){for(var h=0,p=0,v=f[0];null!==(f=i.exec(v));)c.x=parseFloat(f[1]),c.y=parseFloat(f[2]),c.z=parseFloat(f[3]),p++;for(;null!==(f=n.exec(v));)a.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),u.push(c.x,c.y,c.z),s.push(0,0),l.push(l.length),h++;1!==p&&console.log("normalCountPerFace is not 1"),3!==h&&console.log("vertexCountPerFace is not 3"),o++}return{positions:a,normals:u,uvs:s,indices:l}}};t.default=n,e.exports=t.default},function(e,t,r){e.exports=r(31)},function(e,t,r){"use strict";(function(r,n,i,o,a,u,s,l,c,f,h,p,v,y,d,m,b,g,M,_,x,T,E,P,w,O){Object.defineProperty(t,"__esModule",{value:!0}),t.default={Engine:r,Scene:n,Node:i,Env:o,PerspectiveCamera:a,ArcRotateCamera:u,Light:s,DirectionalLight:l,HemisphereLight:c,AmbientLight:f,PointLight:h,MeshBuilder:p,Mesh:v,LineMesh:y,Material:d,RawMaterial:m,StandardMaterial:b,Geometry:g,LineGeometry:M,Mat4:_,Vec3:x,Vec4:T,Quat:E,Ray:P,ObjParser:w,StlParser:O},e.exports=t.default}).call(t,r(32),r(38),r(8),r(3),r(25),r(43),r(4),r(13),r(14),r(15),r(16),r(44),r(5),r(11),r(6),r(12),r(7),r(10),r(24),r(9),r(0),r(22),r(19),r(27),r(28),r(29))},function(e,t,r){"use strict";(function(n,i){function o(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(34),c=o(l),f=r(35),h=o(f),p=r(36),v=o(p),y=r(37),d=o(y),m=function(){function e(t){u(this,e),this.width=0,this.height=0,this._currentProgram=null,this._programs={},this._framebuffers={};var r=this._gl=t.getContext("webgl",{antialias:!0});this.width=t.width,this.height=t.height,this._programs={default:new n({gl:r,fShaderSource:c.default,vShaderSource:h.default}),picker:new n({gl:r,fShaderSource:v.default,vShaderSource:d.default})},this._framebuffers={picker:i.framebufferNotReady?null:this.createFramebuffer({width:this.width,height:this.height}).framebuffer},r.viewport(0,0,this.width,this.height),r.enable(r.DEPTH_TEST),r.getExtension("OES_element_index_uint"),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0)}return s(e,[{key:"clearColorBuffer",value:function(e){var t=this._gl;t.clearColor(e.r/255,e.g/255,e.b/255,void 0!==e.a?e.a/255:1),t.clear(t.COLOR_BUFFER_BIT)}},{key:"clearDepthBuffer",value:function(){var e=this._gl;e.clear(e.DEPTH_BUFFER_BIT)}},{key:"useProgram",value:function(e){this._currentProgram=this._programs[e],this._gl.useProgram(this._currentProgram._program)}},{key:"uniform",value:function(e,t){this._currentProgram.uniform(e,t)}},{key:"attribute",value:function(e,t){this._currentProgram.attribute(e,t)}},{key:"enableDepthMask",value:function(){this._gl.depthMask(!0)}},{key:"disableDepthMask",value:function(){this._gl.depthMask(!1)}},{key:"enableBlend",value:function(){var e=this._gl;e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA)}},{key:"disableBlend",value:function(){var e=this._gl;e.disable(e.BLEND)}},{key:"createAttributeBuffer",value:function(e){var t=this._gl,r=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),r}},{key:"createElementBuffer",value:function(e){var t=this._gl,r=t.createBuffer();return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),r}},{key:"createTexture",value:function(e){var t=this._gl,r=t.createTexture();if(t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e instanceof Uint8Array)t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e);else{t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);var n=function(e){return Math.log(e)/Math.log(2)%1==0};n(e.width)&&n(e.height)&&(t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST))}return r}},{key:"createFramebuffer",value:function(e){var t=e.width,r=e.height,n=e.useColorBuffer,i=void 0!==n&&n,o=this._gl,a=o.createFramebuffer();o.bindFramebuffer(o.FRAMEBUFFER,a);var u=void 0,s=void 0;if(i){var l=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,l),o.renderbufferStorage(o.RENDERBUFFER,o.RGBA4,t,r),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.RENDERBUFFER,l),u=l}else{var c=o.createTexture();o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,c),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,t,r,0,o.RGBA,o.UNSIGNED_BYTE,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,c,0),u=c}var f=o.createRenderbuffer();if(o.bindRenderbuffer(o.RENDERBUFFER,f),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,t,r),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,f),s=f,o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE)throw new Error("framebuffer not ready "+o.checkFramebufferStatus(o.FRAMEBUFFER));return o.bindFramebuffer(o.FRAMEBUFFER,null),{framebuffer:a,colorTarget:u,depthTarget:s}}},{key:"bindFramebuffer",value:function(e){var t=this._gl,r=this._framebuffers[e];r?t.bindFramebuffer(t.FRAMEBUFFER,r):t.bindFramebuffer(t.FRAMEBUFFER,null)}},{key:"lineWidth",value:function(e){this._gl.lineWidth(e)}},{key:"elements",value:function(e){var t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e)}},{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.lines,n=this._gl,i=r?n.LINES:n.TRIANGLES;n.drawElements(i,e,n.UNSIGNED_INT,0)}},{key:"readFramebufferPixel",value:function(e,t,r){var n=this._gl;if(this._framebuffers[e]){this.bindFramebuffer(e);var i=new Uint8Array(4);return n.readPixels(t,r,1,1,n.RGBA,n.UNSIGNED_BYTE,i),this.bindFramebuffer(null),[].concat(a(i))}throw new Error("framebuffer "+e+" not exits")}}]),e}();t.default=m,e.exports=t.default}).call(t,r(33),r(3))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t){var r=t.gl,i=t.fShaderSource,o=t.vShaderSource;n(this,e),this._gl=null,this._program=null,this._uniforms={},this._attributes={},this._textureCount=0,this._gl=r,this._fShaderSource=i,this._vShaderSource=o,this._initProgram()}return i(e,[{key:"_initProgram",value:function(){function e(e,t,r){var n=e.createShader(t);if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw"An error occurred compiling the shaders: "+e.getShaderInfoLog(n);return n}function t(e,t){for(var r=["FLOAT","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","FLOAT_MAT2","FLOAT_MAT3","FLOAT_MAT4","INT","INT_VEC2","INT_VEC3","INT_VEC4","BOOL","BOOL_VEC2","BOOL_VEC3","BOOL_VEC4","SAMPLER_2D","SAMPLER_CUBE"],n=0;n<r.length;n++)if(e[r[n]]===t)return r[n];throw new Error("get type failed ' + value")}var r=this._gl,n=this._fShaderSource,i=this._vShaderSource,o=e(r,r.FRAGMENT_SHADER,n),a=e(r,r.VERTEX_SHADER,i),u=r.createProgram();if(r.attachShader(u,a),r.attachShader(u,o),r.linkProgram(u),!r.getProgramParameter(u,r.LINK_STATUS))throw"Unable to initialize the shader program: "+r.getProgramInfoLog(u);for(var s={},l={},c=r.getProgramParameter(u,r.ACTIVE_ATTRIBUTES),f=0;f<c;f++){var h=r.getActiveAttrib(u,f),p={type:t(r,h.type),position:r.getAttribLocation(u,h.name),info:h};l[h.name]=p}for(var v=r.getProgramParameter(u,r.ACTIVE_UNIFORMS),y=0;y<v;y++){var d=r.getActiveUniform(u,y),m={type:t(r,d.type),position:r.getUniformLocation(u,d.name),info:d};if("2D"===this._parseType(m.type).baseVecType){var b=++this._textureCount;m.unit=b}var g=d.name;g.endsWith("[0]")&&(g=g.replace("[0]","")),s[g]=m}this._program=u,this._attributes=l,this._uniforms=s}},{key:"_parseType",value:function(e){var t=e.split("_")[0],r=e.split("_").length>1?e.split("_")[1]:"VEC1";return{baseType:t,vecType:r,baseVecType:r.substr(0,3),vecSize:Number(r[3])}}},{key:"uniform",value:function(e,t){if(this._uniforms[e]){var r=this._gl,n=this._uniforms[e],i=n.type,o=(n.info,n.position),a=n.unit,u=this._parseType(i),s=u.baseType,l=(u.vecType,u.baseVecType),c=u.vecSize;switch(l){case"VEC":r[["uniform",c,"FLOAT"===s?"f":"i","v"].join("")](o,t);break;case"MAT":r[["uniform","Matrix",c,"fv"].join("")](o,!1,t);break;case"2D":r.activeTexture(r["TEXTURE"+a]),r.bindTexture(r.TEXTURE_2D,t),r.uniform1i(o,a);break;default:throw"baseVecType invalid"}}}},{key:"attribute",value:function(e,t){if(this._attributes[e]){var r=this._gl,n=this._attributes[e],i=n.type,o=(n.info,n.position),a=this._parseType(i),u=a.baseType,s=(a.vecType,a.baseVecType,a.vecSize);r.bindBuffer(r.ARRAY_BUFFER,t),r.vertexAttribPointer(o,s,r[u],!1,0,0),r.enableVertexAttribArray(o)}}}]),e}();t.default=o,e.exports=t.default},function(e,t){e.exports="#ifdef GL_ES\nprecision mediump float;\n#endif\n\n#define PI 3.1415926\n\n#define LIGHT_MAX_COUNT 16\n#define LIGHT_TYPE_NULL 1\n#define LIGHT_TYPE_AMBIENT 2\n#define LIGHT_TYPE_DIRECTIONAL 3\n#define LIGHT_TYPE_POINT 4\n#define LIGHT_TYPE_HEMISPHERE 5\n\n#define MATERIAL_TYPE_RAW 1\n#define MATERIAL_TYPE_STANDARD 2\n\nuniform vec3 uCameraPosition;\n\nuniform int uLightType[LIGHT_MAX_COUNT];\nuniform vec3 uLightColor1[LIGHT_MAX_COUNT];\nuniform vec3 uLightColor2[LIGHT_MAX_COUNT];\nuniform float uLightIntensity[LIGHT_MAX_COUNT];\nuniform vec3 uLightPosition[LIGHT_MAX_COUNT];\n\nuniform int uMaterialType;\nuniform float uMaterialOpacity;\nuniform vec2 uMaterialOffset;\nuniform bool uMaterialAmbientTextureFlag;\nuniform bool uMaterialDiffuseTextureFlag;\nuniform bool uMaterialSpecularTextureFlag;\nuniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform sampler2D uAmbientTexture;\nuniform sampler2D uDiffuseTexture;\nuniform sampler2D uSpecularTexture;\nuniform float uGlossiness;\nuniform bool uEnvMapFlag;\nuniform sampler2D uEnvMapTexture;\n\nvarying vec2 vUV;\nvarying vec3 vNormal;\nvarying vec3 vPosition;\n\nuniform bool manuallyFlipY;\n\nvec2 des2pol(vec3 pos){\n    float r = distance(vec2(pos.x, pos.z), vec2(0.0));\n    float beta = atan(pos.y, r);\n    float v = beta / PI + 0.5;\n    float alpha = atan(pos.x, pos.z);\n    float u = alpha / (PI * 2.0) + 0.5;\n    return vec2(u, v);\n}\n\n\nvec3 applyLights(vec3 ambientColorSource, vec3 diffuseColorSource, vec3 specularColorSource){\n    vec3 colorLighted = vec3(0.0);\n\n    vec3 nNormal = normalize(vNormal);\n    vec3 nViewDirection = normalize(uCameraPosition - vPosition);\n\n    if(uEnvMapFlag){\n        vec3 viewReflect = reflect(-nViewDirection, nNormal);\n        vec2 viewReflectUV = des2pol(viewReflect);\n        vec3 envMapFactor = texture2D(uEnvMapTexture, viewReflectUV).xyz;\n        specularColorSource *= envMapFactor;\n    }\n\n    for(int i = 0; i < LIGHT_MAX_COUNT; i++){\n        int type = uLightType[i];\n        if(type == LIGHT_TYPE_DIRECTIONAL){\n\n            vec3 nLightDir = normalize(uLightPosition[i]);\n\n            float factorLambert = max(dot(nNormal, nLightDir), 0.0);\n            vec3 diffuseIncrement = factorLambert * uLightColor1[i] * uLightIntensity[i] * diffuseColorSource;\n            colorLighted += diffuseIncrement;\n\n            float factorPhong = pow(max(dot(reflect(-nLightDir, nNormal), nViewDirection), 0.0), uGlossiness);\n            vec3 specularIncrement = factorPhong * uLightColor1[i] * uLightIntensity[i] * specularColorSource;\n            colorLighted += specularIncrement;\n\n        }else if(type ==  LIGHT_TYPE_POINT){\n\n            vec3 ray = uLightPosition[i] - vPosition;\n            float rayLen = length(ray);\n            float decayedIntensity = 1.0 / (rayLen * rayLen) * uLightIntensity[i];\n\n            vec3 nLightDir = normalize(ray);\n\n            float factorLambert = abs(dot(normalize(vNormal), nLightDir));\n            vec3 diffuseIncrement = factorLambert * uLightColor1[i] * decayedIntensity * diffuseColorSource;\n            colorLighted += diffuseIncrement;\n\n            float factorPhong = pow(max(dot(reflect(-nLightDir, nNormal), nViewDirection), 0.0), uGlossiness);\n            vec3 specularIncrement = factorPhong * uLightColor1[i] * decayedIntensity * specularColorSource;\n            colorLighted += specularIncrement;\n\n        }else if(type == LIGHT_TYPE_AMBIENT){\n\n            vec3 increment = uLightColor1[i] * uLightIntensity[i] * ambientColorSource;\n            colorLighted += increment;\n\n        }else if(type == LIGHT_TYPE_HEMISPHERE){\n\n            float factor = dot(normalize(vNormal), normalize(uLightPosition[i]));\n            vec3 increment = mix(uLightColor2[i], uLightColor1[i], factor * 0.5 + 0.5) * uLightIntensity[i] * diffuseColorSource;\n            colorLighted += increment;\n\n        }\n    }\n\n    return colorLighted;\n}\n\nvoid main() {\n\n    vec2 offsetedUV = vUV;\n    offsetedUV = fract(offsetedUV + uMaterialOffset);\n    if(manuallyFlipY){\n        offsetedUV.y = 1.0 - offsetedUV.y;\n    }\n\n    vec4 diffuseColorSource = uMaterialDiffuseTextureFlag ? texture2D(uDiffuseTexture, offsetedUV) : vec4(uDiffuseColor, 1.0);\n\n    if(uMaterialType == MATERIAL_TYPE_STANDARD){\n        vec4 ambientColorSource = uMaterialAmbientTextureFlag ? texture2D(uAmbientTexture, offsetedUV) : vec4(uAmbientColor, 1.0);\n        vec4 specularColorSource = uMaterialSpecularTextureFlag ? texture2D(uSpecularTexture, offsetedUV) : vec4(uSpecularColor, 1.0);\n        gl_FragColor = vec4(applyLights(ambientColorSource.xyz, diffuseColorSource.xyz, specularColorSource.xyz), uMaterialOpacity);\n    }else if(uMaterialType == MATERIAL_TYPE_RAW){\n        gl_FragColor = vec4(diffuseColorSource.xyz, uMaterialOpacity);\n    }\n}"},function(e,t){e.exports="attribute vec3 aPosition;\nattribute vec2 aUV;\nattribute vec3 aNormal;\n\nuniform mat4 uPMatrix;\nuniform mat4 uVMatrix;\nuniform mat4 uMMatrix;\n\nuniform bool uMorphTargetFlag;\nuniform float uMorphPhase;\nattribute vec3 aPosition2;\nattribute vec2 aUV2;\nattribute vec3 aNormal2;\n\nvarying vec2 vUV;\nvarying vec3 vNormal;\nvarying vec3 vPosition;\n\nvoid main() {\n\n    vec3 aPositionRes = aPosition;\n    vec2 aUVRes = aUV;\n    vec3 aNormalRes = aNormal;\n\n    if(uMorphTargetFlag){\n        aPositionRes = mix(aPosition, aPosition2, uMorphPhase);\n        aUVRes = mix(aUV, aUV2, uMorphPhase);\n        aNormalRes = mix(aNormal, aNormal2, uMorphPhase);\n    }\n\n    gl_Position = uPMatrix * uVMatrix * uMMatrix * vec4(aPositionRes, 1.0);\n\n    vUV = aUVRes;\n    vNormal = normalize((uMMatrix * vec4( aNormalRes, 0.0)).xyz);\n    vPosition = (uMMatrix * vec4(aPositionRes, 1.0)).xyz;\n}"},function(e,t){e.exports="#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform int meshId;\nvoid main() {\n    float n = float(meshId);\n    float n1 = fract(n / 16.0);\n    n = n / 16.0 - n1;\n    float n2 = fract(n / 16.0);\n    n = n / 16.0 - n2;\n    float n3 = fract(n / 16.0);\n    n = n / 16.0 - n3;\n    float n4 = fract(n / 16.0);\n    gl_FragColor = vec4(n1, n2, n3, n4);\n}"},function(e,t){e.exports="attribute vec3 aPosition;\n\nuniform mat4 uPMatrix;\nuniform mat4 uVMatrix;\nuniform mat4 uMMatrix;\n\nuniform bool uMorphTargetFlag;\nuniform float uMorphPhase;\nattribute vec3 aPosition2;\n\nvoid main() {\n\n    vec3 aPositionRes = aPosition;\n\n    if(uMorphTargetFlag){\n        aPositionRes = mix(aPosition, aPosition2, uMorphPhase);\n    }\n\n    gl_Position = uPMatrix * uVMatrix * uMMatrix * vec4(aPositionRes, 1.0);\n}"},function(e,t,r){"use strict";(function(r,n){function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function(){function e(t){o(this,e),this.clearColor={r:200,g:200,b:200},this.engine=null,this.activeCamera=null,this.meshes=[],this.lights=[],this.renderManager=new r(this),this.engine=t}return a(e,[{key:"render",value:function(){this.renderManager.render()}},{key:"pick",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n.framebufferNotReady?null:(r&&(t=this.engine.height-t),[].concat(i(this.engine.readFramebufferPixel("picker",e,t))).map(function(e){return Math.round(e/16)}).reduceRight(function(e,t){return 16*e+t},0))}}]),e}();t.default=u,e.exports=t.default}).call(t,r(39),r(3))},function(e,t,r){"use strict";(function(r,n,i,o,a,u,s,l,c,f,h){function p(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),d=function(){function e(t){v(this,e),this.scene=null,this.renderData={},this.needUpdateRenderData=!0,this.scene=t}return y(e,[{key:"composeLight",value:function(){var e=this.scene,t=e.lights;if(t.length>16)throw new Error("[G3D] Scene could not have more than 16 lights.");for(var a={type:[],color1:[],color2:[],intensity:[],position:[]},u=0;u<16;u++){var s=t[u];if(s instanceof r){var l,c;a.type.push(3),(l=a.color1).push.apply(l,p(s.getColor())),a.color2.push(0,0,0),a.intensity.push(s.getIntensity()),(c=a.position).push.apply(c,p(s.getDirection()))}else if(s instanceof n){var f,h,v;a.type.push(5),(f=a.color1).push.apply(f,p(s.getSky())),(h=a.color2).push.apply(h,p(s.getGround())),a.intensity.push(s.getIntensity()),(v=a.position).push.apply(v,p(s.getUp()))}else if(s instanceof i){var y;a.type.push(2),(y=a.color1).push.apply(y,p(s.getColor())),a.color2.push(0,0,0),a.intensity.push(s.getIntensity()),a.position.push(0,0,0)}else if(s instanceof o){var d,m;a.type.push(4),(d=a.color1).push.apply(d,p(s.getColor())),a.color2.push(0,0,0),a.intensity.push(s.getIntensity()),(m=a.position).push.apply(m,p(s.getPosition()))}else a.type.push(1),a.color1.push(0,0,0),a.color2.push(0,0,0),a.intensity.push(0),a.position.push(0,0,0)}return{type:new Int32Array(a.type),color1:new Float32Array(a.color1.map(function(e){return e/255})),color2:new Float32Array(a.color2.map(function(e){return e/255})),intensity:new Float32Array(a.intensity),position:new Float32Array(a.position)}}},{key:"groupMeshLayers",value:function(){var e=this.scene,t=e.meshes,r=[];return t.forEach(function(e){var t=e.getRenderLayerIndex();r[t]||(r[t]=[]),r[t].push(e)}),r.filter(Boolean)}},{key:"render",value:function(){if(this.scene.activeCamera){var e=this.groupMeshLayers();this.renderMainLayer(e),a.framebufferNotReady||this.renderPickingLayer(e)}}},{key:"renderMainLayer",value:function(e){var t=this,r=this.scene,n=r.engine;n.useProgram("default"),n.uniform("manuallyFlipY",[Number(a.manuallyFlipY)]),r.engine.uniform("uVMatrix",r.activeCamera.getVMatrix()),r.engine.uniform("uPMatrix",r.activeCamera.getPMatrix()),r.engine.uniform("uCameraPosition",r.activeCamera.getPosition());var i=this.composeLight();n.uniform("uLightType",i.type),n.uniform("uLightColor1",i.color1),n.uniform("uLightColor2",i.color2),n.uniform("uLightIntensity",i.intensity),n.uniform("uLightPosition",i.position),n.clearColorBuffer(r.clearColor),e.forEach(function(e){n.clearDepthBuffer(),e.filter(function(e){return e.getGlobalVisibility()}).forEach(function(e){t.renderMeshMainLayer(e)})})}},{key:"renderMeshMainLayer",value:function(e){var t=this.scene,r=t.engine;if(r.uniform("uMMatrix",e.getWorldMatrix()),e instanceof u){var n=e.getMorphPhaseInfo(),i=n.before,o=n.after,a=n.phase,p=e.morphTargetsGeometries[i].getBuffers(),v=e.morphTargetsGeometries[o].getBuffers();r.uniform("uMorphTargetFlag",[!0]),r.attribute("aPosition",p.vertices),r.attribute("aUV",p.uvs),r.attribute("aNormal",p.normals),r.attribute("aPosition2",v.vertices),r.attribute("aUV2",v.uvs),r.attribute("aNormal2",v.normals),r.uniform("uMorphPhase",[a])}else if(e instanceof s||e instanceof l){var y=e.geometry.getBuffers();r.uniform("uMorphTargetFlag",[!1]),r.attribute("aPosition",y.vertices),r.attribute("aPosition2",y.vertices),r.attribute("aUV",y.uvs),r.attribute("aUV2",y.uvs),r.attribute("aNormal",y.normals),r.attribute("aNormal2",y.normals)}var d=e.materials;for(var m in d){var b=m,g=d[b];g instanceof c?(r.uniform("uMaterialType",[2]),r.uniform("uMaterialAmbientTextureFlag",[Number(g.getAmbientSource()===f.TEXTURE)]),r.uniform("uMaterialDiffuseTextureFlag",[Number(g.getDiffuseSource()===f.TEXTURE)]),r.uniform("uMaterialSpecularTextureFlag",[Number(g.getSpecularSource()===f.TEXTURE)]),g.getUseEnvMap()?(r.uniform("uEnvMapFlag",[Number(!0)]),r.uniform("uEnvMapTexture",g.envMapTexture.getTexture())):r.uniform("uEnvMapFlag",[Number(!1)]),r.uniform("uAmbientColor",g.getAmbientColor()),r.uniform("uAmbientTexture",g.ambientTexture.getTexture()),r.uniform("uDiffuseColor",g.getDiffuseColor()),r.uniform("uDiffuseTexture",g.diffuseTexture.getTexture()),r.uniform("uSpecularColor",g.getSpecularColor()),r.uniform("uSpecularTexture",g.specularTexture.getTexture()),r.uniform("uGlossiness",[g.getGlossiness()])):g instanceof h&&(r.uniform("uMaterialType",[1]),g.getSource()===f.COLOR?r.uniform("uMaterialDiffuseTextureFlag",[Number(!1)]):r.uniform("uMaterialDiffuseTextureFlag",[Number(!0)]),r.uniform("uDiffuseColor",g.getColor()),r.uniform("uDiffuseTexture",g.texture.getTexture())),r.uniform("uMaterialOpacity",[g.getOpacity()]),r.uniform("uMaterialOffset",g.getOffset()),g.getOpacity()<1?(r.enableBlend(),r.disableDepthMask()):(r.enableDepthMask(),r.disableBlend());var M=e.geometry.getBuffers();r.elements(M.indices[b]),e instanceof l?(r.lineWidth(e.lineWidth),r.draw(M.indicesLength[b],{lines:!0})):r.draw(M.indicesLength[b])}e.isDirty=!1}},{key:"renderPickingLayer",value:function(e){var t=this,r=this.scene,n=r.engine;n.useProgram("picker"),n.bindFramebuffer("picker"),n.uniform("uVMatrix",r.activeCamera.getVMatrix()),n.uniform("uPMatrix",r.activeCamera.getPMatrix()),n.clearColorBuffer({r:0,g:0,b:0,a:1}),e.forEach(function(e){n.clearDepthBuffer(),e.filter(function(e){return e.getPickable()}).forEach(function(e){t.renderMeshPickingLayer(e)})}),n.bindFramebuffer(null)}},{key:"renderMeshPickingLayer",value:function(e){var t=this.scene,r=t.engine;if(r.uniform("uMMatrix",e.getWorldMatrix()),e instanceof u){var n=e.getMorphPhaseInfo(),i=n.before,o=n.after,a=n.phase,c=e.morphTargetsGeometries[i].getBuffers(),f=e.morphTargetsGeometries[o].getBuffers();r.uniform("uMorphTargetFlag",[!0]),r.attribute("aPosition",c.vertices),r.attribute("aPosition2",f.vertices),r.uniform("uMorphPhase",[a])}else if(e instanceof s||e instanceof l){var h=e.geometry.getBuffers();r.uniform("uMorphTargetFlag",[!1]),r.attribute("aPosition",h.vertices),r.attribute("aPosition2",h.vertices),r.uniform("uMorphPhase",[0])}r.uniform("meshId",[e.id]);var p=e.materials;for(var v in p){var y=(p[v],e.geometry.getBuffers());r.elements(y.indices[v]),e instanceof l?(r.lineWidth(e.lineWidth),r.draw(y.indicesLength[v],{lines:!0})):r.draw(y.indicesLength[v])}}}]),e}();t.default=d,e.exports=t.default}).call(t,r(13),r(14),r(15),r(16),r(3),r(17),r(5),r(11),r(7),r(6),r(12))},function(e,t,r){"use strict";function n(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function i(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function a(e,t,r,n,i,o,a,u,s,l,c,f,h,p,v,y){var d=new Float32Array(16);return d[0]=e,d[1]=t,d[2]=r,d[3]=n,d[4]=i,d[5]=o,d[6]=a,d[7]=u,d[8]=s,d[9]=l,d[10]=c,d[11]=f,d[12]=h,d[13]=p,d[14]=v,d[15]=y,d}function u(e,t,r,n,i,o,a,u,s,l,c,f,h,p,v,y,d){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e[6]=u,e[7]=s,e[8]=l,e[9]=c,e[10]=f,e[11]=h,e[12]=p,e[13]=v,e[14]=y,e[15]=d,e}function s(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function l(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],o=t[6],a=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function c(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],p=t[11],v=t[12],y=t[13],d=t[14],m=t[15],b=r*u-n*a,g=r*s-i*a,M=r*l-o*a,_=n*s-i*u,x=n*l-o*u,T=i*l-o*s,E=c*y-f*v,P=c*d-h*v,w=c*m-p*v,O=f*d-h*y,A=f*m-p*y,R=h*m-p*d,C=b*R-g*A+M*O+_*w-x*P+T*E;return C?(C=1/C,e[0]=(u*R-s*A+l*O)*C,e[1]=(i*A-n*R-o*O)*C,e[2]=(y*T-d*x+m*_)*C,e[3]=(h*x-f*T-p*_)*C,e[4]=(s*w-a*R-l*P)*C,e[5]=(r*R-i*w+o*P)*C,e[6]=(d*M-v*T-m*g)*C,e[7]=(c*T-h*M+p*g)*C,e[8]=(a*A-u*w+l*E)*C,e[9]=(n*w-r*A-o*E)*C,e[10]=(v*x-y*M+m*b)*C,e[11]=(f*M-c*x-p*b)*C,e[12]=(u*P-a*O-s*E)*C,e[13]=(r*O-n*P+i*E)*C,e[14]=(y*g-v*_-d*b)*C,e[15]=(c*_-f*g+h*b)*C,e):null}function f(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],p=t[11],v=t[12],y=t[13],d=t[14],m=t[15];return e[0]=u*(h*m-p*d)-f*(s*m-l*d)+y*(s*p-l*h),e[1]=-(n*(h*m-p*d)-f*(i*m-o*d)+y*(i*p-o*h)),e[2]=n*(s*m-l*d)-u*(i*m-o*d)+y*(i*l-o*s),e[3]=-(n*(s*p-l*h)-u*(i*p-o*h)+f*(i*l-o*s)),e[4]=-(a*(h*m-p*d)-c*(s*m-l*d)+v*(s*p-l*h)),e[5]=r*(h*m-p*d)-c*(i*m-o*d)+v*(i*p-o*h),e[6]=-(r*(s*m-l*d)-a*(i*m-o*d)+v*(i*l-o*s)),e[7]=r*(s*p-l*h)-a*(i*p-o*h)+c*(i*l-o*s),e[8]=a*(f*m-p*y)-c*(u*m-l*y)+v*(u*p-l*f),e[9]=-(r*(f*m-p*y)-c*(n*m-o*y)+v*(n*p-o*f)),e[10]=r*(u*m-l*y)-a*(n*m-o*y)+v*(n*l-o*u),e[11]=-(r*(u*p-l*f)-a*(n*p-o*f)+c*(n*l-o*u)),e[12]=-(a*(f*d-h*y)-c*(u*d-s*y)+v*(u*h-s*f)),e[13]=r*(f*d-h*y)-c*(n*d-i*y)+v*(n*h-i*f),e[14]=-(r*(u*d-s*y)-a*(n*d-i*y)+v*(n*s-i*u)),e[15]=r*(u*h-s*f)-a*(n*h-i*f)+c*(n*s-i*u),e}function h(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],u=e[6],s=e[7],l=e[8],c=e[9],f=e[10],h=e[11],p=e[12],v=e[13],y=e[14],d=e[15];return(t*a-r*o)*(f*d-h*y)-(t*u-n*o)*(c*d-h*v)+(t*s-i*o)*(c*y-f*v)+(r*u-n*a)*(l*d-h*p)-(r*s-i*a)*(l*y-f*p)+(n*s-i*u)*(l*v-c*p)}function p(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=t[9],p=t[10],v=t[11],y=t[12],d=t[13],m=t[14],b=t[15],g=r[0],M=r[1],_=r[2],x=r[3];return e[0]=g*n+M*u+_*f+x*y,e[1]=g*i+M*s+_*h+x*d,e[2]=g*o+M*l+_*p+x*m,e[3]=g*a+M*c+_*v+x*b,g=r[4],M=r[5],_=r[6],x=r[7],e[4]=g*n+M*u+_*f+x*y,e[5]=g*i+M*s+_*h+x*d,e[6]=g*o+M*l+_*p+x*m,e[7]=g*a+M*c+_*v+x*b,g=r[8],M=r[9],_=r[10],x=r[11],e[8]=g*n+M*u+_*f+x*y,e[9]=g*i+M*s+_*h+x*d,e[10]=g*o+M*l+_*p+x*m,e[11]=g*a+M*c+_*v+x*b,g=r[12],M=r[13],_=r[14],x=r[15],e[12]=g*n+M*u+_*f+x*y,e[13]=g*i+M*s+_*h+x*d,e[14]=g*o+M*l+_*p+x*m,e[15]=g*a+M*c+_*v+x*b,e}function v(e,t,r){var n=r[0],i=r[1],o=r[2],a=void 0,u=void 0,s=void 0,l=void 0,c=void 0,f=void 0,h=void 0,p=void 0,v=void 0,y=void 0,d=void 0,m=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*o+t[12],e[13]=t[1]*n+t[5]*i+t[9]*o+t[13],e[14]=t[2]*n+t[6]*i+t[10]*o+t[14],e[15]=t[3]*n+t[7]*i+t[11]*o+t[15]):(a=t[0],u=t[1],s=t[2],l=t[3],c=t[4],f=t[5],h=t[6],p=t[7],v=t[8],y=t[9],d=t[10],m=t[11],e[0]=a,e[1]=u,e[2]=s,e[3]=l,e[4]=c,e[5]=f,e[6]=h,e[7]=p,e[8]=v,e[9]=y,e[10]=d,e[11]=m,e[12]=a*n+c*i+v*o+t[12],e[13]=u*n+f*i+y*o+t[13],e[14]=s*n+h*i+d*o+t[14],e[15]=l*n+p*i+m*o+t[15]),e}function y(e,t,r){var n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function d(e,t,r,n){var i=n[0],o=n[1],a=n[2],u=Math.sqrt(i*i+o*o+a*a),s=void 0,l=void 0,c=void 0,f=void 0,h=void 0,p=void 0,v=void 0,y=void 0,d=void 0,m=void 0,b=void 0,g=void 0,M=void 0,_=void 0,x=void 0,T=void 0,E=void 0,P=void 0,w=void 0,O=void 0,A=void 0,R=void 0,C=void 0,j=void 0;return Math.abs(u)<H?null:(u=1/u,i*=u,o*=u,a*=u,s=Math.sin(r),l=Math.cos(r),c=1-l,f=t[0],h=t[1],p=t[2],v=t[3],y=t[4],d=t[5],m=t[6],b=t[7],g=t[8],M=t[9],_=t[10],x=t[11],T=i*i*c+l,E=o*i*c+a*s,P=a*i*c-o*s,w=i*o*c-a*s,O=o*o*c+l,A=a*o*c+i*s,R=i*a*c+o*s,C=o*a*c-i*s,j=a*a*c+l,e[0]=f*T+y*E+g*P,e[1]=h*T+d*E+M*P,e[2]=p*T+m*E+_*P,e[3]=v*T+b*E+x*P,e[4]=f*w+y*O+g*A,e[5]=h*w+d*O+M*A,e[6]=p*w+m*O+_*A,e[7]=v*w+b*O+x*A,e[8]=f*R+y*C+g*j,e[9]=h*R+d*C+M*j,e[10]=p*R+m*C+_*j,e[11]=v*R+b*C+x*j,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function m(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],u=t[6],s=t[7],l=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+l*n,e[5]=a*i+c*n,e[6]=u*i+f*n,e[7]=s*i+h*n,e[8]=l*i-o*n,e[9]=c*i-a*n,e[10]=f*i-u*n,e[11]=h*i-s*n,e}function b(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],u=t[2],s=t[3],l=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-l*n,e[1]=a*i-c*n,e[2]=u*i-f*n,e[3]=s*i-h*n,e[8]=o*n+l*i,e[9]=a*n+c*i,e[10]=u*n+f*i,e[11]=s*n+h*i,e}function g(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],u=t[2],s=t[3],l=t[4],c=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+l*n,e[1]=a*i+c*n,e[2]=u*i+f*n,e[3]=s*i+h*n,e[4]=l*i-o*n,e[5]=c*i-a*n,e[6]=f*i-u*n,e[7]=h*i-s*n,e}function M(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function _(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function x(e,t,r){var n=r[0],i=r[1],o=r[2],a=Math.sqrt(n*n+i*i+o*o),u=void 0,s=void 0,l=void 0;return Math.abs(a)<H?null:(a=1/a,n*=a,i*=a,o*=a,u=Math.sin(t),s=Math.cos(t),l=1-s,e[0]=n*n*l+s,e[1]=i*n*l+o*u,e[2]=o*n*l-i*u,e[3]=0,e[4]=n*i*l-o*u,e[5]=i*i*l+s,e[6]=o*i*l+n*u,e[7]=0,e[8]=n*o*l+i*u,e[9]=i*o*l-n*u,e[10]=o*o*l+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function T(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function E(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function P(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function w(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],u=n+n,s=i+i,l=o+o,c=n*u,f=n*s,h=n*l,p=i*s,v=i*l,y=o*l,d=a*u,m=a*s,b=a*l;return e[0]=1-(p+y),e[1]=f+b,e[2]=h-m,e[3]=0,e[4]=f-b,e[5]=1-(c+y),e[6]=v+d,e[7]=0,e[8]=h+m,e[9]=v-d,e[10]=1-(c+p),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function O(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function A(e,t){var r=t[0],n=t[1],i=t[2],o=t[4],a=t[5],u=t[6],s=t[8],l=t[9],c=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(o*o+a*a+u*u),e[2]=Math.sqrt(s*s+l*l+c*c),e}function R(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e}function C(e,t,r,n){var i=t[0],o=t[1],a=t[2],u=t[3],s=i+i,l=o+o,c=a+a,f=i*s,h=i*l,p=i*c,v=o*l,y=o*c,d=a*c,m=u*s,b=u*l,g=u*c,M=n[0],_=n[1],x=n[2];return e[0]=(1-(v+d))*M,e[1]=(h+g)*M,e[2]=(p-b)*M,e[3]=0,e[4]=(h-g)*_,e[5]=(1-(f+d))*_,e[6]=(y+m)*_,e[7]=0,e[8]=(p+b)*x,e[9]=(y-m)*x,e[10]=(1-(f+v))*x,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function j(e,t,r,n,i){var o=t[0],a=t[1],u=t[2],s=t[3],l=o+o,c=a+a,f=u+u,h=o*l,p=o*c,v=o*f,y=a*c,d=a*f,m=u*f,b=s*l,g=s*c,M=s*f,_=n[0],x=n[1],T=n[2],E=i[0],P=i[1],w=i[2];return e[0]=(1-(y+m))*_,e[1]=(p+M)*_,e[2]=(v-g)*_,e[3]=0,e[4]=(p-M)*x,e[5]=(1-(h+m))*x,e[6]=(d+b)*x,e[7]=0,e[8]=(v+g)*T,e[9]=(d-b)*T,e[10]=(1-(h+y))*T,e[11]=0,e[12]=r[0]+E-(e[0]*E+e[4]*P+e[8]*w),e[13]=r[1]+P-(e[1]*E+e[5]*P+e[9]*w),e[14]=r[2]+w-(e[2]*E+e[6]*P+e[10]*w),e[15]=1,e}function F(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,u=n+n,s=i+i,l=r*a,c=n*a,f=n*u,h=i*a,p=i*u,v=i*s,y=o*a,d=o*u,m=o*s;return e[0]=1-f-v,e[1]=c+m,e[2]=h-d,e[3]=0,e[4]=c-m,e[5]=1-l-v,e[6]=p+y,e[7]=0,e[8]=h+d,e[9]=p-y,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function k(e,t,r,n,i,o,a){var u=1/(r-t),s=1/(i-n),l=1/(o-a);return e[0]=2*o*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*s,e[6]=0,e[7]=0,e[8]=(r+t)*u,e[9]=(i+n)*s,e[10]=(a+o)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*l,e[15]=0,e}function L(e,t,r,n,i){var o=1/Math.tan(t/2),a=1/(n-i);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*a,e[15]=0,e}function S(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),s=2/(a+u),l=2/(i+o);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(a-u)*s*.5,e[9]=(i-o)*l*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function D(e,t,r,n,i,o,a){var u=1/(t-r),s=1/(n-i),l=1/(o-a);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*u,e[13]=(i+n)*s,e[14]=(a+o)*l,e[15]=1,e}function I(e,t,r,n){var i=void 0,o=void 0,a=void 0,u=void 0,l=void 0,c=void 0,f=void 0,h=void 0,p=void 0,v=void 0,y=t[0],d=t[1],m=t[2],b=n[0],g=n[1],M=n[2],_=r[0],x=r[1],T=r[2];return Math.abs(y-_)<H&&Math.abs(d-x)<H&&Math.abs(m-T)<H?s(e):(f=y-_,h=d-x,p=m-T,v=1/Math.sqrt(f*f+h*h+p*p),f*=v,h*=v,p*=v,i=g*p-M*h,o=M*f-b*p,a=b*h-g*f,v=Math.sqrt(i*i+o*o+a*a),v?(v=1/v,i*=v,o*=v,a*=v):(i=0,o=0,a=0),u=h*a-p*o,l=p*i-f*a,c=f*o-h*i,v=Math.sqrt(u*u+l*l+c*c),v?(v=1/v,u*=v,l*=v,c*=v):(u=0,l=0,c=0),e[0]=i,e[1]=u,e[2]=f,e[3]=0,e[4]=o,e[5]=l,e[6]=h,e[7]=0,e[8]=a,e[9]=c,e[10]=p,e[11]=0,e[12]=-(i*y+o*d+a*m),e[13]=-(u*y+l*d+c*m),e[14]=-(f*y+h*d+p*m),e[15]=1,e)}function U(e,t,r,n){var i=t[0],o=t[1],a=t[2],u=n[0],s=n[1],l=n[2],c=i-r[0],f=o-r[1],h=a-r[2],p=c*c+f*f+h*h;p>0&&(p=1/Math.sqrt(p),c*=p,f*=p,h*=p);var v=s*h-l*f,y=l*c-u*h,d=u*f-s*c;return e[0]=v,e[1]=y,e[2]=d,e[3]=0,e[4]=f*d-h*y,e[5]=h*v-c*d,e[6]=c*y-f*v,e[7]=0,e[8]=c,e[9]=f,e[10]=h,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e}function z(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function N(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function V(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function B(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function G(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function q(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function X(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Y(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],h=e[10],p=e[11],v=e[12],y=e[13],d=e[14],m=e[15],b=t[0],g=t[1],M=t[2],_=t[3],x=t[4],T=t[5],E=t[6],P=t[7],w=t[8],O=t[9],A=t[10],R=t[11],C=t[12],j=t[13],F=t[14],k=t[15];return Math.abs(r-b)<=H*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-g)<=H*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(i-M)<=H*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(o-_)<=H*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-x)<=H*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(u-T)<=H*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(s-E)<=H*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(l-P)<=H*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(c-w)<=H*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(f-O)<=H*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(h-A)<=H*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(p-R)<=H*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(v-C)<=H*Math.max(1,Math.abs(v),Math.abs(C))&&Math.abs(y-j)<=H*Math.max(1,Math.abs(y),Math.abs(j))&&Math.abs(d-F)<=H*Math.max(1,Math.abs(d),Math.abs(F))&&Math.abs(m-k)<=H*Math.max(1,Math.abs(m),Math.abs(k))}Object.defineProperty(t,"__esModule",{value:!0}),t.create=n,t.clone=i,t.copy=o,t.fromValues=a,t.set=u,t.identity=s,t.transpose=l,t.invert=c,t.adjoint=f,t.determinant=h,t.multiply=p,t.translate=v,t.scale=y,t.rotate=d,t.rotateX=m,t.rotateY=b,t.rotateZ=g,t.fromTranslation=M,t.fromScaling=_,t.fromRotation=x,t.fromXRotation=T,t.fromYRotation=E,t.fromZRotation=P,t.fromRotationTranslation=w,t.getTranslation=O,t.getScaling=A,t.getRotation=R,t.fromRotationTranslationScale=C,t.fromRotationTranslationScaleOrigin=j,t.fromQuat=F,t.frustum=k,t.perspective=L,t.perspectiveFromFieldOfView=S,t.ortho=D,t.lookAt=I,t.targetTo=U,t.str=z,t.frob=N,t.add=V,t.subtract=B,t.multiplyScalar=G,t.multiplyScalarAndAdd=q,t.exactEquals=X,t.equals=Y;var H=1e-6;t.mul=p,t.sub=B},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function o(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function a(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function u(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return 0!=n?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function s(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],u=r[0],s=r[1],l=r[2],c=r[3];return e[0]=n*c+a*u+i*l-o*s,e[1]=i*c+a*s+o*u-n*l,e[2]=o*c+a*l+n*s-i*u,e[3]=a*c-n*u-i*s-o*l,e}function l(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s+a*u,e[1]=i*s+o*u,e[2]=o*s-i*u,e[3]=a*s-n*u,e}function c(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s-o*u,e[1]=i*s+a*u,e[2]=o*s+n*u,e[3]=a*s-i*u,e}function f(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],a=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s+i*u,e[1]=i*s-n*u,e[2]=o*s+a*u,e[3]=a*s-o*u,e}function h(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function p(e,t,r,n){var i=t[0],o=t[1],a=t[2],u=t[3],s=r[0],l=r[1],c=r[2],f=r[3],h=void 0,p=void 0,v=void 0,y=void 0,d=void 0;return p=i*s+o*l+a*c+u*f,p<0&&(p=-p,s=-s,l=-l,c=-c,f=-f),1-p>1e-6?(h=Math.acos(p),v=Math.sin(h),y=Math.sin((1-n)*h)/v,d=Math.sin(n*h)/v):(y=1-n,d=n),e[0]=y*i+d*s,e[1]=y*o+d*l,e[2]=y*a+d*c,e[3]=y*u+d*f,e}function v(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o,u=a?1/a:0;return e[0]=-r*u,e[1]=-n*u,e[2]=-i*u,e[3]=o*u,e}function y(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function d(e,t){var r=t[0]+t[4]+t[8],n=void 0;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*o+a]-t[3*a+o])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[a]=(t[3*a+i]+t[3*i+a])*n}return e}function m(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var o=Math.sin(t),a=Math.cos(t),u=Math.sin(r),s=Math.cos(r),l=Math.sin(n),c=Math.cos(n);return e[0]=o*s*c-a*u*l,e[1]=a*u*c+o*s*l,e[2]=a*s*l-o*u*c,e[3]=a*s*c+o*u*l,e}function b(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=i,t.identity=o,t.setAxisAngle=a,t.getAxisAngle=u,t.multiply=s,t.rotateX=l,t.rotateY=c,t.rotateZ=f,t.calculateW=h,t.slerp=p,t.invert=v,t.conjugate=y,t.fromMat3=d,t.fromEuler=m,t.str=b;var g=r(42),M=n(g),_=r(20),x=n(_),T=r(21),E=n(T),P=(t.clone=E.clone,t.fromValues=E.fromValues,t.copy=E.copy,t.set=E.set,t.add=E.add,t.mul=s,t.scale=E.scale,t.dot=E.dot,t.lerp=E.lerp,t.length=E.length),w=(t.len=P,t.squaredLength=E.squaredLength),O=(t.sqrLen=w,t.normalize=E.normalize);t.exactEquals=E.exactEquals,t.equals=E.equals,t.rotationTo=function(){var e=x.create(),t=x.fromValues(1,0,0),r=x.fromValues(0,1,0);return function(n,i,o){var u=x.dot(i,o);return u<-.999999?(x.cross(e,t,i),x.len(e)<1e-6&&x.cross(e,r,i),x.normalize(e,e),a(n,e,Math.PI),n):u>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(x.cross(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+u,O(n,n))}}(),t.sqlerp=function(){var e=i(),t=i();return function(r,n,i,o,a,u){return p(e,n,a,u),p(t,i,o,u),p(r,e,t,2*u*(1-u)),r}}(),t.setAxes=function(){var e=M.create();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],O(t,d(t,e))}}()},function(e,t,r){"use strict";function n(){var e=new Float32Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function i(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function o(e){var t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function u(e,t,r,n,i,o,a,u,s){var l=new Float32Array(9);return l[0]=e,l[1]=t,l[2]=r,l[3]=n,l[4]=i,l[5]=o,l[6]=a,l[7]=u,l[8]=s,l}function s(e,t,r,n,i,o,a,u,s,l){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e[6]=u,e[7]=s,e[8]=l,e}function l(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function c(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function f(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=c*a-u*l,h=-c*o+u*s,p=l*o-a*s,v=r*f+n*h+i*p;return v?(v=1/v,e[0]=f*v,e[1]=(-c*n+i*l)*v,e[2]=(u*n-i*a)*v,e[3]=h*v,e[4]=(c*r-i*s)*v,e[5]=(-u*r+i*o)*v,e[6]=p*v,e[7]=(-l*r+n*s)*v,e[8]=(a*r-n*o)*v,e):null}function h(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8];return e[0]=a*c-u*l,e[1]=i*l-n*c,e[2]=n*u-i*a,e[3]=u*s-o*c,e[4]=r*c-i*s,e[5]=i*o-r*u,e[6]=o*l-a*s,e[7]=n*s-r*l,e[8]=r*a-n*o,e}function p(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],u=e[6],s=e[7],l=e[8];return t*(l*o-a*s)+r*(-l*i+a*u)+n*(s*i-o*u)}function v(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=r[0],p=r[1],v=r[2],y=r[3],d=r[4],m=r[5],b=r[6],g=r[7],M=r[8];return e[0]=h*n+p*a+v*l,e[1]=h*i+p*u+v*c,e[2]=h*o+p*s+v*f,e[3]=y*n+d*a+m*l,e[4]=y*i+d*u+m*c,e[5]=y*o+d*s+m*f,e[6]=b*n+g*a+M*l,e[7]=b*i+g*u+M*c,e[8]=b*o+g*s+M*f,e}function y(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=r[0],p=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=u,e[5]=s,e[6]=h*n+p*a+l,e[7]=h*i+p*u+c,e[8]=h*o+p*s+f,e}function d(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],l=t[6],c=t[7],f=t[8],h=Math.sin(r),p=Math.cos(r);return e[0]=p*n+h*a,e[1]=p*i+h*u,e[2]=p*o+h*s,e[3]=p*a-h*n,e[4]=p*u-h*i,e[5]=p*s-h*o,e[6]=l,e[7]=c,e[8]=f,e}function m(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function b(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function g(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function M(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function _(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function x(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,u=n+n,s=i+i,l=r*a,c=n*a,f=n*u,h=i*a,p=i*u,v=i*s,y=o*a,d=o*u,m=o*s;return e[0]=1-f-v,e[3]=c-m,e[6]=h+d,e[1]=c+m,e[4]=1-l-v,e[7]=p-y,e[2]=h-d,e[5]=p+y,e[8]=1-l-f,e}function T(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],l=t[7],c=t[8],f=t[9],h=t[10],p=t[11],v=t[12],y=t[13],d=t[14],m=t[15],b=r*u-n*a,g=r*s-i*a,M=r*l-o*a,_=n*s-i*u,x=n*l-o*u,T=i*l-o*s,E=c*y-f*v,P=c*d-h*v,w=c*m-p*v,O=f*d-h*y,A=f*m-p*y,R=h*m-p*d,C=b*R-g*A+M*O+_*w-x*P+T*E;return C?(C=1/C,e[0]=(u*R-s*A+l*O)*C,e[1]=(s*w-a*R-l*P)*C,e[2]=(a*A-u*w+l*E)*C,e[3]=(i*A-n*R-o*O)*C,e[4]=(r*R-i*w+o*P)*C,e[5]=(n*w-r*A-o*E)*C,e[6]=(y*T-d*x+m*_)*C,e[7]=(d*M-v*T-m*g)*C,e[8]=(v*x-y*M+m*b)*C,e):null}function E(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function P(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function w(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}function O(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function A(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function R(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function C(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e}function j(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function F(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=t[0],h=t[1],p=t[2],v=t[3],y=t[4],d=t[5],m=t[6],b=t[7],g=t[8];return Math.abs(r-f)<=k*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-h)<=k*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-p)<=k*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-v)<=k*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(a-y)<=k*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(u-d)<=k*Math.max(1,Math.abs(u),Math.abs(d))&&Math.abs(s-m)<=k*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-b)<=k*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(c-g)<=k*Math.max(1,Math.abs(c),Math.abs(g))}Object.defineProperty(t,"__esModule",{value:!0}),t.create=n,t.fromMat4=i,t.clone=o,t.copy=a,t.fromValues=u,t.set=s,t.identity=l,t.transpose=c,t.invert=f,t.adjoint=h,t.determinant=p,t.multiply=v,t.translate=y,t.rotate=d,t.scale=m,t.fromTranslation=b,t.fromRotation=g,t.fromScaling=M,t.fromMat2d=_,t.fromQuat=x,t.normalFromMat4=T,t.projection=E,t.str=P,t.frob=w,t.add=O,t.subtract=A,t.multiplyScalar=R,t.multiplyScalarAndAdd=C,t.exactEquals=j,t.equals=F;var k=1e-6;t.mul=v,t.sub=A},function(e,t,r){"use strict";(function(r,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},l=function(e){function t(e,r,n,a,u){i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Math.PI/2,1,101));return s.radius=0,s.alpha=0,s.beta=0,s}return a(t,e),u(t,[{key:"getVMatrix",value:function(){var e=Math.cos(n.deg2rad(this.beta))*this.radius,r=Math.sin(n.deg2rad(this.beta))*this.radius,i=Math.sin(n.deg2rad(this.alpha))*e,o=Math.cos(n.deg2rad(this.alpha))*e,a=this.center;return this.position.x=a.x+i,this.position.y=a.y+r,this.position.z=a.z+o,s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getVMatrix",this).call(this)}}]),t}(r);t.default=l,e.exports=t.default}).call(t,r(25),r(26))},function(e,t,r){"use strict";(function(r,n,i,o,a,u,s,l,c,f){function h(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var v=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),y=function(){function e(){p(this,e)}return v(e,null,[{key:"createGround",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=t/2,o=n/2,a=new r(e);return a.geometry.vertices=[-i,o,0,-i,-o,0,i,-o,0,i,o,0],a.geometry.uvs=[0,1,0,0,1,0,1,1],a.geometry.normals=[0,0,1,0,0,1,0,0,1,0,0,1],a.geometry.indices.default=[0,1,2,0,2,3],a}},{key:"createCube",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,o=r/2,a=n/2,u=i/2;return e.createBox(t,-o,o,a,-a,u,-u)}},{key:"createBox",value:function(e,t,n,i,o,a,u){var s=new r(e);return s.geometry.vertices=[t,i,a,n,i,a,n,o,a,t,o,a,t,i,u,n,i,u,n,o,u,t,o,u,t,o,a,t,i,a,t,i,u,t,o,u,n,o,a,n,i,a,n,i,u,n,o,u,t,i,a,n,i,a,n,i,u,t,i,u,t,o,a,n,o,a,n,o,u,t,o,u],s.geometry.uvs=[0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0],s.geometry.normals=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],s.geometry.indices.default=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],s}},{key:"createSphere",value:function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,a=2*Math.PI,u=Math.PI,s=[],l=[],c=[],f=[],p=[],v=0,y=0;y<=o;y++){for(var d=[],m=y/o,b=0;b<=i;b++){var g=b/i,M=-t*Math.cos(0+g*a)*Math.sin(0+m*u),_=t*Math.cos(0+m*u),x=t*Math.sin(0+g*a)*Math.sin(0+m*u);l.push(M,_,x);var T=n.normalize(n.create(),n.fromValues(M,_,x));c.push.apply(c,h(T)),f.push(g,m),d.push(v++)}p.push(d)}for(var E=0;E<o;E++)for(var P=0;P<i;P++){var w=p[E][P+1],O=p[E][P],A=p[E+1][P],R=p[E+1][P+1];0!==E&&s.push(w,O,R),(E!==o-1||u<Math.PI)&&s.push(O,A,R)}var C=new r(e);return C.geometry.vertices=l,C.geometry.uvs=f,C.geometry.normals=c,C.geometry.indices.default=s,C}},{key:"createCylinder",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,o=[],a=[],u=[],s=[],l=2*Math.PI/i,c=n/2,f=function(e){var r=o.length/3,n=[0,c*e,0],f=[0,e,0],h=[0,0];o.push.apply(o,n),u.push.apply(u,f),a.push.apply(a,h);for(var p=0;p<i;p++){var v=p*l,y=[Math.cos(v)*t,c*e,Math.sin(v)*t];o.push.apply(o,y),u.push.apply(u,f),a.push.apply(a,h),p!==i-1?s.push(r,r+p+1,r+p+2):s.push(r,r+p+1,r+1)}};!function(){for(var e=o.length/3,r=0;r<i;r++){var n=l*r,f=[Math.cos(n)*t,-c,Math.sin(n)*t],h=[Math.cos(n)*t,c,Math.sin(n)*t],p=[f[0],0,f[2]],v=[h[0],0,h[2]];o.push.apply(o,f.concat(h)),a.push(0,0,0,0),u.push.apply(u,p.concat(v));var y=2*r;r===i-1?s.push(y,y+1,e+1,y,e,e+1):s.push(y,y+1,y+3,y,y+3,y+2)}}(),f(1),f(-1);var h=new r(e);return h.geometry.vertices=o,h.geometry.uvs=a,h.geometry.normals=u,h.geometry.indices.default=s,h}},{key:"createCone",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,o=[],a=[],u=[],s=[],l=n/2,c=2*Math.PI/i;!function(){for(var e=o.length/3,r=[0,l,0],f=Math.atan(t/n),h=Math.cos(f),p=Math.sin(f),v=0;v<i;v++){var y=c*v,d=[Math.cos(y)*t,-l,Math.sin(y)*t],m=[Math.cos(y)*h,p,Math.sin(y)*h],b=[0,0];o.push.apply(o,r.concat(d)),u.push.apply(u,m.concat(m)),a.push.apply(a,b.concat(b));var g=e+2*v;v!==i-1?s.push(g,g+1,g+3):s.push(g,g+1,e+1)}}(),function(e){var r=o.length/3,n=[0,l*e,0],f=[0,e,0],h=[0,0];o.push.apply(o,n),u.push.apply(u,f),a.push.apply(a,h);for(var p=0;p<i;p++){var v=p*c,y=[Math.cos(v)*t,l*e,Math.sin(v)*t];o.push.apply(o,y),u.push.apply(u,f),a.push.apply(a,h),p!==i-1?s.push(r,r+p+1,r+p+2):s.push(r,r+p+1,r+1)}}(-1);var f=new r(e);return f.geometry.vertices=o,f.geometry.uvs=a,f.geometry.normals=u,f.geometry.indices.default=s,f}},{key:"createCoordinate",value:function(e,t){var n=new r(e),o=new i(e);o.geometry.vertices=[0,0,0,t,0,0],o.geometry.indices.default=[0,1],o.materials.default.color.r=256,o.materials.default.color.g=0,o.materials.default.color.b=0,o.parent=n;var a=new i(e);a.geometry.vertices=[0,0,0,0,t,0],a.geometry.indices.default=[0,1],a.materials.default.color.r=0,a.materials.default.color.g=256,a.materials.default.color.b=0,a.parent=n;var u=new i(e);return u.geometry.vertices=[0,0,0,0,0,t],u.geometry.indices.default=[0,1],u.materials.default.color.r=0,u.materials.default.color.g=0,u.materials.default.color.b=256,u.parent=n,n}},{key:"createFromObjModel",value:function(e,t){t=o.parse(t);var n=function(e){var t=[];return e.forEach(function(e){return t.push.apply(t,h(e))}),t},i=new r(e);i.geometry.vertices=n(t.positions),i.geometry.uvs=n(t.uvs),i.geometry.normals=n(t.normals);for(var l in t.indices)!function(e){var r=t.indices[e],n=t.mtls[e];if(n){if(i.geometry.indices[e]=r,i.materials[e]||(i.materials[e]=new a(i)),n.ambientColor&&(i.materials[e].ambientColor={r:255*n.ambientColor[0],g:255*n.ambientColor[1],b:255*n.ambientColor[2]}),n.ambientTexture){var o=new u.Image;o.crossOrigin=!0,o.onload=function(){i.materials[e].ambientTexture.image=o,i.materials[e].ambientSource=s.TEXTURE},o.src=n.ambientTexture}if(n.diffuseColor&&(i.materials[e].diffuseColor={r:255*n.diffuseColor[0],g:255*n.diffuseColor[1],b:255*n.diffuseColor[2]}),n.diffuseTexture){var l=new u.Image;l.crossOrigin=!0,l.onload=function(){i.materials[e].diffuseTexture.image=l,i.materials[e].diffuseSource=s.TEXTURE},l.src=n.diffuseTexture}if(n.specularColor&&(i.materials[e].specularColor={r:255*n.specularColor[0],g:255*n.specularColor[1],b:255*n.specularColor[2]}),n.specularTexture){var c=new u.Image;c.crossOrigin=!0,c.onload=function(){i.materials[e].specularTexture.image=c,i.materials[e].specularSource=s.TEXTURE},c.src=n.specularTexture}}else i.geometry.indices.default=r}(l);return i}},{key:"createFromStlModel",value:function(e,t){t=l.parse(t);var n=new r(e);return n.geometry.vertices=t.positions,n.geometry.uvs=t.uvs,n.geometry.normals=t.normals,n.geometry.indices.default=t.indices,n}},{key:"createFromG3DModel",value:function(e,t){var r=new c(e);r.geometry.vertices=[],r.geometry.uvs=[],r.geometry.normals=[],r.geometry.indices.default=[];for(var i=function(e,t){for(var r=[],i=[],o=[],a=0;a<t.length;a+=8)for(var u,s,l,c,f=[t[a+1],t[a+2],t[a+3]],p=f.map(function(t){return[e[3*t],e[3*t+1],e[3*t+2]]}),v=n.sub(n.create(),(u=n).fromValues.apply(u,h(p[0])),(s=n).fromValues.apply(s,h(p[1]))),y=n.sub(n.create(),(l=n).fromValues.apply(l,h(p[0])),(c=n).fromValues.apply(c,h(p[2]))),d=n.cross(n.create(),v,y),m=0;m<3;m++){f[m];r.push.apply(r,h(p[m])),i.push(0,0),o.push.apply(o,h(d))}return{vertices:r,uvs:i,normals:o}},o=0;o<t.faces.length;o+=8){var a=o/8;r.geometry.indices.default.push(3*a,3*a+1,3*a+2)}var u=i(t.vertices,t.faces),s=u.vertices,l=u.uvs,p=u.normals;return r.geometry.vertices=s,r.geometry.uvs=l,r.geometry.normals=p,r.morphTargetsGeometries=t.morphTargets.map(function(e){var n=i(e.vertices,t.faces),o=n.vertices,a=n.uvs,u=n.normals,s=new f(r);return s.vertices=o,s.uvs=a,s.normals=u,s.indices=r.geometry.indices,s}),r}},{key:"createWireFrameFromMesh",value:function(e,t){function r(e,t){var r=e+"-"+t,i=t+"-"+e;o[r]||o[i]||n.geometry.indices.default.push(e,t)}var n=new i(e),o={};n.geometry.vertices=[].concat(h(t.geometry.vertices));for(var a in t.geometry.indices)for(var u=t.geometry.indices[a],s=0;s<u.length;s+=3)r(u[s],u[s+1]),r(u[s],u[s+2]),r(u[s+1],u[s+2]);return n}},{key:"createBoundingBoxFromMesh",value:function(e,t){var r=t.geometry.vertices;if(r.length>0){var n=void 0,i=void 0,o=void 0,a=void 0,u=void 0,s=void 0;n=i=o=a=u=s=null;for(var l=0;l<r.length;l+=3){var c=r[l],f=r[l+1],h=r[l+2];null===n?(n=i=c,o=a=f,u=s=h):(n=Math.min(n,c),i=Math.max(i,c),a=Math.min(a,f),o=Math.max(o,f),s=Math.min(s,h),u=Math.max(u,h))}return this.createBox(e,n,i,o,a,u,s)}}}]),e}();t.default=y,e.exports=t.default}).call(t,r(5),r(0),r(11),r(28),r(7),r(3),r(6),r(29),r(17),r(10))}])});